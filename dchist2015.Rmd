---
title: "dchs2015"
author: "George Oberle"
date: "August 3, 2015"
output: html_document
---


#Institutionalizing Knowledge in Early Washington D.C.  

In Democracy in America, Alexander de Tocqueville observed that “In democratic countries the science of association is the mother of science; the progress of all the rest depends upon the progress it has made.” Tocqueville noted that Americans formed numerous associations for distinct purposes and whose goals included establishing schools and churches, and spreading knowledge through the publication of information of interest to like-minded citizens.  The residents of the District of Columbia, America’s federal city, sought to create a thriving metropolis crowded with a vibrant and extensive community of scholars. Many hoped a national institution would materialize to promote the expansion of knowledge and learning. This paper explores the purpose and composition of the myriad societies in the early federal city, especially scientific, literary and proto-professional societies, 1815-1850. This paper examines the shared relationships between these groups using computational tools and methods to develop network analysis using society membership lists.

##Introduction
In addition to being the site for the national government, the District of Columbia was the home of many different societies dedicated to the collection and dissemination of useful knowledge. Typically, scholars characterize these institutions as localized groups with grand designs limited by parochial insights and miserly pocketbooks. This paper seeks to explore the make-up of the local institutions and to utilize computational methods to examine if these local institutions were more cosmopolitan in nature. 

Introduction
Hook
Questions
What were the institutions and what did they do?
Who joined these institutions?
Were they interrelated?
Did they connect to organization outside of DC?

##Methods
  * Organizations
  * Membership Lists
	+ Columbian Agricultural Society
    + Columbian Institute for the Promotion of Arts and Sciences
    + DC Medical Society
    + National Institute of Science
  + Military Philosophical Society


###Membership Lists
<h3>Membership Rolls: Collecting Data</h3>
Finding and collecting data from the various organizations that existed in Early Washington is a tedious project and fraught with challenges. There are limited archival sources from the organizations themselves. Some of the more complete examples of these include the Columbian Institute for the Promotion of Arts and Sciences its successor the National Institution (Institute) for the Promotion of Science both available in the Smithsonian Archives. Further, the Medical Society of the District of Columbia’s records are at the National Library of Medicine. Occasionally organizations published the names of their membership in their journals or other proceedings such as the Columbian Agricultural Society.  Most typically there seem to be hints or references to the associations in scattered newspaper accounts, memoirs, or government records. Despite the restrictions of the source pool, there are ways to utilize the existing data to ask new questions from old sources.


Data

```{r}

#Load tools
library (sp)
library (rgdal)
library (rgeos)
library (maptools)
library (ggmap)
library (ggplot2)
library (mullenMisc)
library (magrittr)
library (stringr)
library (dplyr)
library (RColorBrewer)
library (igraph)
```

```{r}
#Load membership rollls data

data = read.csv("~/Desktop/DCHS2015/data/learnsoc1.csv")

```

After reading the data this sample set of membership lists from a variety of different learned societies between x and y. The list has 2262 members lists coming from x organizations.

```{r}

data_members <- graph.data.frame(data, directed = FALSE)
plot (data_members, vertex.label = NA)
title("Test", sub = "A network graph of members",cex.main = 2,   font.main= 4, col.main= "blue", cex.sub = 0.75, font.sub = 3, col.sub = "red")

```


```{r}
data_members <- graph.data.frame(data, directed = FALSE)
plot (data_members)
title("Test", sub = "A network graph of members with name labels",cex.main = 2,   font.main= 4, col.main= "blue", cex.sub = 0.75, font.sub = 3, col.sub = "red")
```

```{r}
V(data_members)
bipartite.mapping(data_members)
V(data_members)$type <- bipartite.mapping(data_members)$type
is.bipartite(data_members)
plot(data_members, layout = layout.bipartite, vertex.label = NA)
title("Test", sub = "A bipartite layout of members and organizations",cex.main = 2,   font.main= 4, col.main= "blue", cex.sub = 0.75, font.sub = 3, col.sub = "red")
```


```{r}
full_members <- bipartite.projection(data_members)
```


```{r}
#Just the organizations
plot(full_members$proj2)
title("Test", sub = "Just the Organizations",cex.main = 2,   font.main= 4, col.main= "blue", cex.sub = 2, font.sub = 3, col.sub = "red")
```

```{r}
E(full_members$proj2)
E(full_members$proj2)$weight
range01 <- function(x){(x-min(x))/(max(x)-min(x))}
range01(E(full_members$proj2)$weight)
```


```{r}
plot(full_members$proj2, edge.width = range01(E(full_members$proj2)$weight) * 20)
title("Organizations", sub = "Weighted by Shared Members",cex.main = 2,   font.main= 4, col.main= "blue", cex.sub = 2, font.sub = 3, col.sub = "red")
```


```{r}
org <- ggplot(data, aes(Organization))
org + geom_bar(width=.5, fill="blue", color="darkblue") + coord_flip() +ggtitle ("Total Members of Societies DC relations")

```


##Appendix 1 List of Societies in Washington D.C.
Columbian Institute
Washington D.C. 


Methods
  Organizations
	Membership Lists
		Columbian Agricultural Society
		Columbian Institute for the Promotion of Arts and Sciences
		National Institute of Science
	
Analysis

Conclusion



Columbian Agricultural Society
Columbian Institute for the Promotion of Arts and Sciences
Medical Society of the District of Columbia
Enosinian Society –Columbian College
Washington Relief Society 1830
Female Union Benevolent Society of Washington City
Washington Monument Society
Washington Literary Society
Washington Library Company
Washington Female Orphan Society
Washington Orphan Asylum
Washington Botanical Society
Washington Bible Society
Washington Benevolent Society of Young Men
Washington Art League
Washington Art Association
Columbia Typographical Society
Odd Fellows
Grand United Order of Odd fellows
Grand United Order of colored Odd fellows
National Institution (Institute) for the Promotion of Science
Mechanics Institute
Consumers Protective Association
Columbian Institution for the Deaf, Dumb and Blind
Columbian Hospital for Women and Lying in Asylum
American Tract Society
American Colonization Society
  The establishment of the seat of government 
nation’s capital in Washington D.C. 

Data
Columbian Institute
Washington D.C. 
Introduction
Hook
Questions
What were the institutions and what did they do?
Who joined these institutions?
Were they interrelated?
Did they connect to organization outside of DC?

Methods
	Organizations
	Membership Lists
		Columbian Agricultural Society
		Columbian Institute for the Promotion of Arts and Sciences
		National Institute of Science
	
Analysis

Conclusion


Ask Lincoln for help with this. I am having trouble with this and the
library one.
Information from URL : http://maps.googleapis.com/maps/api/geocode/json?address=Abingdon+VA&sensor=false
Error in readLines(connect) : cannot open the connection
In addition: Warning message:
In readLines(connect) : unable to resolve 'maps.googleapis.com'



```{r}
#I would like to use this to compare with development of other institutions. 
milit_soc <- read.csv("~/Desktop/DCHS2015/data/militacadlist.csv")
milit_soc<- milit_soc%>%
mutate(location=paste (City, State))
location_geocoded <- geocode(milit_soc$location)
milit_soc_geocoded <- cbind(milit_soc, location_geocoded)
milit_soc_geocoded
write.csv(milit_soc_geocoded, file = "milit_soc_geocoded.csv")

```

```{r}
#Load data
schol = read.csv("~/Desktop/DCHS2015/data/schol-soc-geocoded.csv")
coll = read.csv("~/Desktop/DCHS2015/data/early_colleges_geocoded.csv")
militgeo = read.csv("~/Desktop/DCHS2015/data/milit_soc_geocoded.csv")
#Preparing 1830 Map
map_sp <- readOGR("nhgis-shp/", "state_1830")
class(map_sp)
str(map_sp, max.level = 2)
map_sp@bbox
map_sp@proj4string
head(map_sp@data)
plot(map_sp)

map_sp1 <- readOGR("nhgis-shp/", "state_1840")
class(map_sp1)
str(map_sp1, max.level = 2)
map_sp1@bbox
map_sp1@proj4string
head(map_sp1@data)
plot(map_sp1)

map1830<- readOGR ("nhgis-shp" , "state_1830")
map1840<- readOGR ("nhgis-shp" , "state_1840")
map1850<- readOGR ("nhgis-shp" , "state_1850")

fort<- fortify (map1830)
fort2<- fortify (map1840)
fort3<- fortify (map1850)

ggplot () + geom_map(data=fort, map=fort, aes(x=long, y=lat, group=group, map_id=id), color="black", fill="white") +geom_point(data=coll, aes (x=lon, y=lat), color="red") + coord_map()

ggplot () + geom_map(data=fort3, map=fort3, aes(x=long, y=lat, group=group, map_id=id), color="black", fill="white") +geom_point(data=milit_soc_geocoded, aes (x=lon, y=lat), color="red") + coord_map()

ggplot () + geom_map(data=fort, map=fort, aes(x=long, y=lat, group=group, map_id=id), color="black", fill="white") +geom_point(data=coll, aes (x=lon, y=lat, color=factor(established)) ) + coord_map()

ggplot () + geom_map(data=fort, map=fort, aes(x=long, y=lat, group=group, map_id=id), color="black", fill="white") +geom_point(data=coll, aes (x=lon, y=lat, color=factor(period), shape=factor(period)) ) + coord_map()

ggplot () + geom_map(data=fort2, map=fort2, aes(x=long, y=lat, group=group, map_id=id), color="black", fill="white") +geom_point(data=coll, aes (x=lon, y=lat, color=factor(period), shape=factor(period)) ) + coord_map()
 
```

```{r}
library(leaflet)

leaflet() %>%
  addTiles() %>%
  addPolygons(data = map1850, fillOpacity = 0, weight = 1, color = "black") %>%
  addCircleMarkers(data = schol, color = "blue", fillOpacity = 0) %>%
  addCircleMarkers(data = coll, color = "red") %>%
  addCircleMarkers(data = militgeo, color = "green")
```



State Born for the Government Data.


Mapping The Larger Picture. Need Library Dataset and add above military.




#create period function
periodize <- function(year) {
  period <- NA
  period <- ifelse(year >= 1776, "Colonial", period)
  period <- ifelse(year >= 1776 & year <= 1828, "Early National", period)
  period <- ifelse(year >1828, "Antebellum", period)
  return(period)
  
 #These are the processes to use to add columns for geocoded.
early_colleges<- early_colleges%>%
mutate(location=paste (city, state))
location_geocoded <- geocode(early_colleges$location)
early_colleges_geocoded <- cbind(early_colleges, location_geocoded)
early_colleges_geocoded

#Thanks to Colleagues